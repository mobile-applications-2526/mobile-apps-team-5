<div class="create-form-wrap">
  <ion-card>
    <ion-card-header>
      <ion-card-title>Create Activity</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      
      <form [formGroup]="form" (ngSubmit)="submit()">

        <ion-item>
          <ion-label position="stacked">Name</ion-label>
          <ion-input formControlName="name" placeholder="e.g. Friday Drinks"></ion-input>
        </ion-item>
        <ion-text color="danger" *ngIf="f['name'].touched && f['name'].errors?.['required']">
          <small>Name is required.</small>
        </ion-text>

        <ion-item>
          <ion-label position="stacked">Category</ion-label>
          <ion-select formControlName="category" placeholder="Select">
            <ion-select-option *ngFor="let c of categories" [value]="c.id">
              {{ c.name }}
            </ion-select-option>
          </ion-select>
        </ion-item>
        <ion-text color="danger" *ngIf="f['category'].touched && f['category'].errors?.['required']">
          <small>Category is required.</small>
        </ion-text>

        <ion-item>
          <ion-label position="stacked">Location</ion-label>
          <ion-input formControlName="location" placeholder="e.g. Oude Markt"></ion-input>
        </ion-item>
        <ion-text color="danger" *ngIf="f['location'].touched && f['location'].errors?.['required']">
          <small>Location is required.</small>
        </ion-text>

        <ion-item>
          <ion-label position="stacked">Description</ion-label>
          <ion-textarea formControlName="description" rows="3" placeholder="Details..."></ion-textarea>
        </ion-item>
        <ion-text color="danger" *ngIf="f['description'].touched && f['description'].errors?.['minlength']">
          <small>Description must be at least 10 characters.</small>
        </ion-text>

        <div class="participants" style="display: flex; gap: 10px; margin-top: 10px;">
          <div class="col" style="flex: 1;">
            <ion-item lines="none">
              <ion-label position="stacked">Min</ion-label>
              <ion-input type="number" formControlName="minParticipants"></ion-input>
            </ion-item>
          </div>
          <div class="col" style="flex: 1;">
            <ion-item lines="none">
              <ion-label position="stacked">Max</ion-label>
              <ion-input type="number" formControlName="maxParticipants"></ion-input>
            </ion-item>
          </div>
        </div>
        <ion-text color="danger" *ngIf="form.errors?.['minGreaterThanMax']">
          <small>Min must be less than Max.</small>
        </ion-text>

        <ion-item class="ion-margin-bottom">
          <ion-label position="stacked">Date proposal</ion-label>
          
          <ion-datetime-button datetime="datetime-picker"></ion-datetime-button>
          
          <ion-modal [keepContentsMounted]="true">
            <ng-template>
              <ion-datetime 
                id="datetime-picker" 
                presentation="date-time"
                [showDefaultButtons]="true"
                [preferWheel]="true"
                [value]="form.get('date')?.value"
                (ionChange)="onDateChange($event)">
              </ion-datetime>
            </ng-template>
          </ion-modal>
        </ion-item>
        <ion-text color="danger" *ngIf="f['date'].touched && f['date'].errors?.['required']">
          <small>Date is required.</small>
        </ion-text>

        <ion-item class="ion-margin-bottom">
          <ion-label position="stacked">Image (Optional)</ion-label>
          <input type="file" accept="image/*" (change)="onFileChange($event)" />
        </ion-item>

        <div class="actions" style="margin-top: 20px;">
          <ion-button expand="block" type="submit" class="submit" [disabled]="loading">
            <span *ngIf="!loading">Post Activity Proposal</span>
            <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
          </ion-button>
        </div>

      </form>
    </ion-card-content>
  </ion-card>
</div>